# 11 更大的代码盒子—模块和包

更新时间：2019-09-06 09:45:46

![img](img/5d71ba0f0001ab4406400359.jpg)

![img](img/bg-l-1584237354783.png)![img](img/bg-r-1584237354785.png)

勤学如春起之苗，不见其增，日有所长。

——陶潜



### 什么是模块

之前介绍过两种运行 Python 代码的方式，一种是解释器的交互模式，另一种是直接运行 Python 代码文件。

在 Python 中，每一个 Python 代码文件就是一个**模块**。写程序时，我们可以将代码分散在不同的模块（文件）中，然后在一个模块里引用另一个模块的内容。



### 模块的导入

在一个模块中引用（导入）另一个模块，可以使用 `import` 语句:

```python
import 模块名
```

这里的模块名是除去 `.py` 后缀的文件名称。如，想要导入模块 `abc.py`，只需 `import abc`。

`import` 模块之后，就可以使用被导入模块中的名字（变量、函数类）。方式如下：

```python
模块名.变量
模块名.函数
模块名.类
```

#### 导入及使用模块示例

我们用个例子来试验下模块的导入和使用，在这个例子中，农民种下果树，然后等待果树结果收获。

在同一个目录下创建两个模块：

```undefined
tree_farmer  # 目录名
	|___tree.py # 文件名
	|___farmer.py # 文件名
```

第一个模块名为 `tree.py`，内容如下：

```python
import random

fruit_name = ''

def harvest():
    return [fruit_name] * random.randint(1, 9)
```

代码中各个变量和函数的功能如下：

- `fruit_name` 用来保存水果名称。将在函数 `harvest()` 中使用；
- `random.randint(1, 9)`，随机生成 1～9 中的一个数；
- `[fruit_name] * 数字`，该形式是将列表项重复若干遍。比如执行 `['X'] * 3` 将得到 `['X', 'X', 'X']`；
- 总体而言，`harvest()` 函数返回一个包含 1～9 个列表项的列表，其中每个项都是 `fruit_name` 的值。

第二个模块名为 `farmer.py`，内容如下：

```python
import tree

print('种下一棵果树。')
tree.fruit_name = 'apple'

print('等啊等，树长大了，可以收获了！')
fruits = tree.harvest()
print(fruits)
```

代码中，

- 第一行用 `import tree` 将 `tree.py` 模块导入进来（使用 `import` 导入时不需要写 `.py` 后缀）；
- 导入 `tree` 模块后，就可以使用其中的变量和函数了。将 `tree.fruit_name` 设置为 apple，调用 `tree.harvest()` 来收获 apple。

执行下模块 `farmer.py` 看看：

> ➜ ~ python3 farmer.py
> 种下一棵果树。
> 等啊等，树长大了，可以收获了！
> [‘apple’, ‘apple’, ‘apple’, ‘apple’]

> 说明：apple 随机出现 1～9 个，所以你的结果可能和这里不一样。

可以看到，执行 `farmer.py` 时，由于 `tree.py` 模块被导入，所以可以在 `farmer.py` 中使用 `tree.py` 的内容。

#### 标准库模块的导入

上面的例子中，我们自己定义了模块，然后在其它模块中使用它。其中有个地方不知道你有没有注意到，`tree.py` 的第一行代码是 `import random`，`random` 并不是我们所定义的模块，那它是从哪里来的呢？

`random` 是标准库中的一个模块。标准库是由 Python 官方开发的代码库，和解释器一起打包分发，其中包含非常多实用的模块，我们在使用时直接 `import` 进来即可。



### 执行模块时传入参数

刚才我们用这种方式来执行模块：

```sh
python3 模块文件名
```

其实我们还可以进一步将参数传递到模块中去，像这样：

```sh
python3 模块文件名 参数1 ...参数n
```

参数传递到模块中以后，我们可以通过 `sys` 模块来取出这些参数，参数放在 `sys.argv` 列表中：

```python
import sys

模块文件名 = sys.argv[0]
参数1     = sys.argv[1]
参数N     = sys.argv[N]
```

首先需要导入 `sys` 模块，这是个标准库中的模块。`sys.argv` 是个列表，执行模块时被传递进来的参数保存在其中，它的列表项分别为：

- `sys.argv[0]` 保存当前被执行模块的文件名
- `sys.argv[1]` 保存第 1 个参数
- `sys.argv[2]` 保存第 2 个参数
- 依次类推

之前种果树那个例子中，`farmer.py` 固定种苹果树，我们可以改进一下，具体种什么树由传递的模块参数来决定。

修改 `farmer.py` 的代码，内容如下：

```python
import sys  # 新增
import tree

print('种下一棵果树。')
tree.fruit_name = sys.argv[1]   # 将 'apple' 改为 参数 sys.argv[1]

print('等啊等，树长大了，可以收获了！')
fruits = tree.harvest()
print(fruits)
```

以「banana」为例执行下看看：

> ➜ ~ python3 farmer.py banana
> 种下一棵果树。
> 等啊等，树长大了，可以收获了！
> [‘banana’, ‘banana’, ‘banana’]

在这个例子中 `sys.argv` 的值是：

- `sys.argv[0]`： farmer.py
- `sys.argv[1]`： banana



### 什么是包

之前我们将定义的两个模块放在同一目录下，然后通过 `import` 语句来相互引用，这是一种扁平的模块组织结构，当模块数量很大的时候就很不灵活了，也难以维护。

Python 中可以用文件树这样的树形结构来组织模块，这种组织形式下的模块集合称为**包**（Package）。

比如包的结构可以是这样的：

```
包/
├── __init__.py
├── 模块1.py
├── 模块2.py
├── 子包1/
    ├── __init__.py
    ├── 模块3.py
    └── 模块4.py
└── 子包2/
    ├── __init__.py
    ├── 模块5.py
    └── 孙子包1/
        ├── __init__.py
        └── 模块6.py
```

这是个很明显的层级结构——包里面包含子包、子包包含孙子包…… 单独将子包或孙子包拿出来，它们也是包。

包的存在形式是目录，模块的存在形式是目录下的文件。所以我们可以很容易地构造出这样一个包，只要在文件系统中创建相应的目录和文件即可。

需要注意的是，每个层级的包下都需要有一个 `__init__.py` 模块。这是因为只有当目录中存在 `__init__.py` 时，Python 才会把这个目录当作包。



### 包的导入

导入包中模块的方法是：

```python
import 包.子包.模块
```

从最顶层的包开始依次向下引用子包，直至目标模块。

如，从上面示例的包结构中，

导入 `模块1.py`，使用：

```python
import 包.模块1
```

导入 `模块3.py`，使用：

```python
import 包.子包1.模块3
```

导入 `模块6.py`，使用：

```python
import 包.子包2.孙子包1.模块6
```



### 为什么需要模块和包

模块的存在是为了更好的组织代码。将不同功能的代码分散在不同模块中，清晰地划分出各个模块的职责，有利于使用和维护代码，同时也可避免模块中的内容过长。

包的存在是为了更好的组织模块。与模块同理，包在更高的抽象层次上组织着代码。



### 总结

模块可以更好的组织代码，它的存在形式是文件。包的可以更好的组织模块，它的存在形式是目录。

导入模块使用 `import` 语句：

```python
import 模块名
```

导入包下的模块：

```python
import 包名.模块名
```

模块导入后，可以使用该模块中所定义的名字（变量、函数类）。方式如下：

```python
模块名.变量
模块名.函数
模块名.类
```

[10 定制一个模子—类](https://www.imooc.com/read/46/article/819)[12 练习—密码生成器](https://www.imooc.com/read/46/article/821)

精选留言 1

欢迎在这里发表留言，作者筛选后可公开显示

- [杨杨0713](https://www.imooc.com/u/2123257/articles)

  from 怎么没有看到？

   2

  回复

  举报

  2019-11-20

  - [源代码_思无邪](https://www.imooc.com/u/1890535/articles)

    回复[杨杨0713](https://www.imooc.com/u/2123257/articles)

    导入另一个模块的类，必须得用from。

    回复

    2020-02-18 20:26:43

 